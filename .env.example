# ============================================================================
# DATABASE CONFIGURATION
# ============================================================================
# Option 1: Use local docker postgres (recommended for development)
# Set DATABASE_PASSWORD and postgres container will auto-configure
DATABASE_PASSWORD=your-secure-postgres-password

# Optional: customize postgres connection (defaults shown)
# DATABASE_USER=postgres
# DATABASE_HOST=postgres
# DATABASE_PORT=5432
# DATABASE_NAME=sinas

# Option 2: Use external database (for production)
# Set DATABASE_URL to override local postgres completely
# DATABASE_URL=postgresql://user:password@external-host:5432/sinas

# ============================================================================
# APPLICATION CONFIGURATION
# ============================================================================
APP_PORT=51245
DEBUG=false
SECRET_KEY=your-secret-key-change-in-production-must-be-secure
ALGORITHM=HS256

# JWT Token Configuration (Best Practice: Short access tokens + Long refresh tokens)
# ACCESS_TOKEN_EXPIRE_MINUTES=15      # Short-lived access tokens (default: 15 min)
# REFRESH_TOKEN_EXPIRE_DAYS=30        # Long-lived refresh tokens (default: 30 days)

# OTP Configuration
OTP_EXPIRE_MINUTES=10

# ============================================================================
# EXTERNAL AUTHENTICATION (Optional - OIDC/OAuth2)
# ============================================================================
# Enable external authentication (Authentik, Auth0, Keycloak, etc.)
# EXTERNAL_AUTH_ENABLED=true

# OIDC Provider Configuration
# OIDC_ISSUER=https://authentik.company.com/application/o/sinas/
# OIDC_AUDIENCE=sinas
# OIDC_GROUPS_CLAIM=groups  # JWT claim containing user groups

# User/Group Provisioning
# AUTO_PROVISION_USERS=true    # Create users on first login
# AUTO_PROVISION_GROUPS=false  # Auto-create SINAS groups for unmapped external groups
# DEFAULT_GROUP_NAME=Users     # Fallback group for users without mapped groups

# Note: Map external groups to SINAS groups via the Groups API:
# PATCH /api/v1/groups/{group_id} with {"external_group_id": "external-group-id"}

# SINAS Application Container Resource Limits
APP_CPU_LIMIT=2.0              # Max CPU cores for the app container
APP_MEMORY_LIMIT=2G            # Max RAM for the app container
APP_CPU_RESERVATION=0.5        # Guaranteed CPU cores
APP_MEMORY_RESERVATION=512M    # Guaranteed RAM

# ============================================================================
# HTTPS CONFIGURATION (Caddy)
# ============================================================================
# Set your domain name for automatic HTTPS with Let's Encrypt
# For local development, leave as localhost (no HTTPS)
DOMAIN=localhost

# ============================================================================
# SMTP CONFIGURATION (for sending OTP emails)
# ============================================================================
SMTP_DOMAIN=example.com
SMTP_HOST=smtp.example.com
SMTP_PORT=587
SMTP_USER=your-smtp-user
SMTP_PASSWORD=your-smtp-password

# ============================================================================
# FUNCTIONS CONFIGURATION
# ============================================================================
# Functions always execute in Docker containers for security and isolation

# Resource limits per function execution
FUNCTION_TIMEOUT=300              # Max execution time in seconds (5 minutes)
MAX_FUNCTION_MEMORY=512           # Memory limit in MB
MAX_FUNCTION_CPU=1.0              # CPU cores (1.0 = 1 full core, 0.5 = half core)
MAX_FUNCTION_STORAGE=1g           # Disk storage limit (e.g., "500m", "1g")
# FUNCTION_CONTAINER_IMAGE=sinas-executor  # Advanced: Override executor image (defaults to sinas-executor)
FUNCTION_CONTAINER_IDLE_TIMEOUT=3600       # Seconds before idle container cleanup (1 hour)

# Package management
ALLOW_PACKAGE_INSTALLATION=true   # Allow pip install in functions
# ALLOWED_PACKAGES=                # Comma-separated whitelist (empty = all allowed)

# ============================================================================
# FILE STORAGE CONFIGURATION
# ============================================================================
# Storage backend (currently only "local" is supported)
# FILE_STORAGE_BACKEND=local

# Local file storage path (inside container)
# FILE_STORAGE_PATH=/var/sinas/files

# ============================================================================
# Encryption (for encrypting sensitive data like database connection strings)
# Generate with: python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
ENCRYPTION_KEY=your-encryption-key-here

# Admin user (created automatically on startup)
# The user with this email will be added to the Admins group with full system access
# Only creates user if Admins group is empty
SUPERADMIN_EMAIL=youremail@example.com

# ============================================================================
# DECLARATIVE CONFIGURATION (GitOps / Infrastructure as Code)
# ============================================================================
# Path to YAML configuration file
# CONFIG_FILE=/path/to/sinas-config.yaml
# CONFIG_FILE=config/default-data.yaml

# Auto-apply configuration file on startup
# AUTO_APPLY_CONFIG=true

